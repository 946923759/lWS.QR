<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <link rel="stylesheet" type="text/css" href="common.css">

    <script type="text/javascript" src="qrcode.min.js"></script>

    <script type="text/javascript">
      console.log('start head script');
    var qrenc;
    function QR (size, dark, light, cor) {
      var cl = QRCode.CorrectLevel.L;
      switch(cor) {
          case 'L':
                cl=QRCode.CorrectLevel.L
                break;
          case 'M':
                cl=QRCode.CorrectLevel.M
                break;
          case 'Q':
                cl=QRCode.CorrectLevel.Q
                break;
          case 'H':
                cl=QRCode.CorrectLevel.H
                break;
          default:
                cl=QRCode.CorrectLevel.L

      }  
      qrenc = new QRCode(document.getElementById('qrcode'), {
          text: '',
          width: size,
          height : size,
          colorDark : dark,
          colorLight : light,
          correctLevel : cl
      });
    }
    function refresh() {
          console.log('start refresh()');
          var mSize = document.getElementById('size').value;
          var mDark = document.getElementById('dark').value;
          var mLight = document.getElementById('light').value;
          var mCorr = document.getElementById('corr').value;
          if (mSize > 1024 || mSize < 64) mSize = 128;
          if (!checkRGB(mDark)) mDark = '#000000';
          if (!checkRGB(mLight)) mLight = '#FFFFFF';
          document.getElementById('qrcode').innerHTML='';
          QR(
            mSize,
            mDark,
            mLight,
            document.getElementById('corr').value
          );
          qrenc.clear();
          qrenc.makeCode(document.getElementById('qrtext').value);
                console.log('finish refresh()');
    }
    function setDefault() {
          console.log('start setDefault()');
          document.getElementById('qrcode').innerHTML='';
          QR('128', '#0000ff', '#00ffff', 'H');
          qrenc.clear();
          qrenc.makeCode(document.getElementById('qrtext').value);
                console.log('finish setDefault()');
    }
    function checkRGB(color) {
        return color.match(/^\#[0-9A-Fa-f]{3}|^\#[0-9A-Fa-f]{6}/);
    }
          console.log('finish head script');
    </script>

</head>
<body>

    <!-- Main tab -->
    <div id="Main" class="tab" style="display:block">

<div id="qrcode" style="margin:25px"></div>

<form><br>  <textarea
      placeholder="Enter text to encode here..."
      cols="31"
      rows="3"
      id="qrtext"
      onkeyup="
        refresh();
      "
  ></textarea>
  <br/>
  <button
      type="button"
      onClick="refresh();"
       console.log('encode button');     
  >
Encode
  </button>
  <button
      type="button"
      onClick="
          qrenc.clear();
          qrenc.makeCode('');
          document.getElementById('qrtext').value = '';
      "
  >
Clear
  </button>
  <br />
  Size [64 - 1024]
  <input type="number" id="size" size="4" value="256" onkeyup="refresh();" style="width:3em;" />
  <br />
  Color dark/light [#RGB or #RRGGBB]<br />
  <input type="text" id="dark" size="7" value="#000000" onkeyup="refresh();" />/
  <input type="text" id="light" size="7" value="#ffffff" onkeyup="refresh();"/>
  <br />
  Correction level
  <select name="correction" id="corr" value="L" onchange="refresh();">
      <option value="L">L (7%)</option>
      <option value="M">M (15%)</option>
      <option value="Q">Q (25%)</option>
      <option value="H">H (30%)</option>
  </select>
</form>

    <script>
    QR('128', '#000000', '#FFFFFF', 'L');
    qrenc.clear();
    qrenc.makeCode('');
    </script>

        </div>

</body>

</html>
